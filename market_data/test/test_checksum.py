#!/usr/bin/env python3
"""
@author: Arthurim
@Description:
"""
import unittest

from market_data.src.orderbooks import check_sum

DEBUG_TIME = 1


class TestCheckSums(unittest.TestCase):

    def test_checksum(self):
        api_book_str = {'sym': 'XBTUSD', 'market': 'KRAKEN', 'marketTimestamp': {},
                        'bid': {'33035.10000': '5.12965941', '33035.00000': '0.01150000', '33034.00000': '0.15067597',
                                '33033.40000': '0.00010544', '33032.90000': '0.52900000', '33029.90000': '0.07490279',
                                '33029.80000': '0.27292692', '33027.60000': '1.92290000', '33027.00000': '0.30269068',
                                '33026.40000': '0.18000000'},
                        'ask': {'33035.20000': '0.49527187', '33044.80000': '0.30597849', '33047.50000': '0.75679694',
                                '33050.70000': '0.28405435', '33050.80000': '1.51439320', '33052.30000': '0.03161318',
                                '33054.00000': '0.06324278', '33056.00000': '0.06072724', '33057.00000': '1.51413414',
                                '33063.40000': '2.50893626'}}
        api_book_str_prev = {'sym': 'XBTUSD', 'market': 'KRAKEN', 'marketTimestamp': {},
                             'bid': {'33035.10000': '5.12965941', '33035.00000': '0.01150000',
                                     '33034.00000': '0.15067597', '33033.40000': '0.00010544',
                                     '33032.90000': '0.52900000', '33029.90000': '0.07490279',
                                     '33029.80000': '0.27292692', '33027.60000': '1.92290000',
                                     '33027.00000': '0.30269068', '33026.40000': '0.18000000'},
                             'ask': {'33035.20000': '0.49527187', '33044.80000': '0.30597849',
                                     '33047.50000': '0.75679694', '33050.70000': '0.28405435',
                                     '33050.80000': '1.51439320', '33052.30000': '0.03161318',
                                     '33054.00000': '0.06324278', '33056.00000': '0.06072724',
                                     '33057.00000': '1.51413414', '33063.40000': '2.50893626'}}
        upd = {'a': [['33050.70000', '0.28405435', '1624628890.916524']], 'marketTimestamp': '1624628890.916524',
               'c': '3410465702'}
        checksum = '3410465702'
        self.assertTrue(check_sum(api_book_str, checksum, api_book_str_prev, upd), "Failed checksum")


if __name__ == "__main__":
    unittest.main()
    print("Everything passed")
